import{AnimationClip,BufferAttribute,FileLoader,Loader,NumberKeyframeTrack}from"three";class MDDLoader extends Loader{constructor(e){super(e)}load(e,t,r,a){const o=this,n=new FileLoader(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.load(e,(function(e){t(o.parse(e))}),r,a)}parse(e){const t=new DataView(e),r=t.getUint32(0),a=t.getUint32(4);let o=8;const n=new Float32Array(r),l=new Float32Array(r*r).fill(0);for(let e=0;e<r;e++)n[e]=t.getFloat32(o),o+=4,l[r*e+e]=1;const s=new NumberKeyframeTrack(".morphTargetInfluences",n,l),i=new AnimationClip("default",n[n.length-1],[s]),f=[];for(let e=0;e<r;e++){const r=new Float32Array(3*a);for(let e=0;e<a;e++){const a=3*e;r[a+0]=t.getFloat32(o),o+=4,r[a+1]=t.getFloat32(o),o+=4,r[a+2]=t.getFloat32(o),o+=4}const n=new BufferAttribute(r,3);n.name="morph_"+e,f.push(n)}return{morphTargets:f,clip:i}}}export{MDDLoader};