import{FileLoader,Loader,ShapePath}from"three";class FontLoader extends Loader{constructor(e){super(e)}load(e,t,o,a){const s=this,r=new FileLoader(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,(function(e){const o=s.parse(JSON.parse(e));t&&t(o)}),o,a)}parse(e){return new Font(e)}}class Font{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const o=[],a=createPaths(e,t,this.data);for(let e=0,t=a.length;e<t;e++)o.push(...a[e].toShapes());return o}}function createPaths(e,t,o){const a=Array.from(e),s=t/o.resolution,r=(o.boundingBox.yMax-o.boundingBox.yMin+o.underlineThickness)*s,n=[];let i=0,h=0;for(let e=0;e<a.length;e++){const t=a[e];if("\n"===t)i=0,h-=r;else{const e=createPath(t,s,i,h,o);i+=e.offsetX,n.push(e.path)}}return n}function createPath(e,t,o,a,s){const r=s.glyphs[e]||s.glyphs["?"];if(!r)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+s.familyName+".");const n=new ShapePath;let i,h,c,l,u,d,p,f;if(r.o){const e=r._cachedOutline||(r._cachedOutline=r.o.split(" "));for(let s=0,r=e.length;s<r;)switch(e[s++]){case"m":i=e[s++]*t+o,h=e[s++]*t+a,n.moveTo(i,h);break;case"l":i=e[s++]*t+o,h=e[s++]*t+a,n.lineTo(i,h);break;case"q":c=e[s++]*t+o,l=e[s++]*t+a,u=e[s++]*t+o,d=e[s++]*t+a,n.quadraticCurveTo(u,d,c,l);break;case"b":c=e[s++]*t+o,l=e[s++]*t+a,u=e[s++]*t+o,d=e[s++]*t+a,p=e[s++]*t+o,f=e[s++]*t+a,n.bezierCurveTo(u,d,p,f,c,l)}}return{offsetX:r.ha*t,path:n}}export{FontLoader,Font};