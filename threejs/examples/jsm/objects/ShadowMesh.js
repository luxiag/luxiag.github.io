import{Matrix4,Mesh,MeshBasicMaterial,EqualStencilFunc,IncrementStencilOp}from"three";const _shadowMatrix=new Matrix4;class ShadowMesh extends Mesh{constructor(t){const a=new MeshBasicMaterial({color:0,transparent:!0,opacity:.6,depthWrite:!1,stencilWrite:!0,stencilFunc:EqualStencilFunc,stencilRef:0,stencilZPass:IncrementStencilOp});super(t.geometry,a),this.isShadowMesh=!0,this.meshMatrix=t.matrixWorld,this.frustumCulled=!1,this.matrixAutoUpdate=!1}update(t,a){const n=t.normal.x*a.x+t.normal.y*a.y+t.normal.z*a.z+-t.constant*a.w,e=_shadowMatrix.elements;e[0]=n-a.x*t.normal.x,e[4]=-a.x*t.normal.y,e[8]=-a.x*t.normal.z,e[12]=-a.x*-t.constant,e[1]=-a.y*t.normal.x,e[5]=n-a.y*t.normal.y,e[9]=-a.y*t.normal.z,e[13]=-a.y*-t.constant,e[2]=-a.z*t.normal.x,e[6]=-a.z*t.normal.y,e[10]=n-a.z*t.normal.z,e[14]=-a.z*-t.constant,e[3]=-a.w*t.normal.x,e[7]=-a.w*t.normal.y,e[11]=-a.w*t.normal.z,e[15]=n-a.w*-t.constant,this.matrix.multiplyMatrices(_shadowMatrix,this.meshMatrix)}}export{ShadowMesh};