"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[407],{41731:(a,n,s)=>{s.r(n),s.d(n,{default:()=>v});var t=s(71534),e=s(32049),c=s(86171),p=s(97630),o=s(45751),d=s(62928);const l=(0,t.uE)('<div class="language-javascript line-numbers-mode" data-ext="js" data-v-720ca9e7><pre class="language-javascript" data-v-720ca9e7><code data-v-720ca9e7><span class="token keyword" data-v-720ca9e7>const</span> loader <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>FileLoader</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n\nloader<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>load</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token string" data-v-720ca9e7>&quot;/geojson/china.json&quot;</span><span class="token punctuation" data-v-720ca9e7>,</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>data</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>=&gt;</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n    <span class="token keyword" data-v-720ca9e7>const</span> jsData <span class="token operator" data-v-720ca9e7>=</span> <span class="token constant" data-v-720ca9e7>JSON</span><span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>parse</span><span class="token punctuation" data-v-720ca9e7>(</span>data<span class="token punctuation" data-v-720ca9e7>)</span>\n    <span class="token function" data-v-720ca9e7>operationData</span><span class="token punctuation" data-v-720ca9e7>(</span>jsData<span class="token punctuation" data-v-720ca9e7>)</span>\n<span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span>\n\n<span class="token keyword" data-v-720ca9e7>function</span> <span class="token function" data-v-720ca9e7>operationData</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>jsondata</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n  <span class="token comment" data-v-720ca9e7>// 全国信息</span>\n  <span class="token keyword" data-v-720ca9e7>const</span> features <span class="token operator" data-v-720ca9e7>=</span> jsondata<span class="token punctuation" data-v-720ca9e7>.</span>features<span class="token punctuation" data-v-720ca9e7>;</span>\n\n  features<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>forEach</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>feature</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>=&gt;</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n    <span class="token comment" data-v-720ca9e7>// 单个省份 对象</span>\n    <span class="token keyword" data-v-720ca9e7>const</span> province <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>Object3D</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n    <span class="token comment" data-v-720ca9e7>// 地址</span>\n    province<span class="token punctuation" data-v-720ca9e7>.</span>properties <span class="token operator" data-v-720ca9e7>=</span> feature<span class="token punctuation" data-v-720ca9e7>.</span>properties<span class="token punctuation" data-v-720ca9e7>.</span>name<span class="token punctuation" data-v-720ca9e7>;</span>\n    <span class="token keyword" data-v-720ca9e7>const</span> coordinates <span class="token operator" data-v-720ca9e7>=</span> feature<span class="token punctuation" data-v-720ca9e7>.</span>geometry<span class="token punctuation" data-v-720ca9e7>.</span>coordinates<span class="token punctuation" data-v-720ca9e7>;</span>\n    <span class="token keyword" data-v-720ca9e7>const</span> color <span class="token operator" data-v-720ca9e7>=</span> <span class="token string" data-v-720ca9e7>&quot;#99ff99&quot;</span><span class="token punctuation" data-v-720ca9e7>;</span>\n\n    <span class="token keyword" data-v-720ca9e7>if</span> <span class="token punctuation" data-v-720ca9e7>(</span>feature<span class="token punctuation" data-v-720ca9e7>.</span>geometry<span class="token punctuation" data-v-720ca9e7>.</span>type <span class="token operator" data-v-720ca9e7>===</span> <span class="token string" data-v-720ca9e7>&quot;MultiPolygon&quot;</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n      <span class="token comment" data-v-720ca9e7>// 多个，多边形</span>\n      coordinates<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>forEach</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>coordinate</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>=&gt;</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n        <span class="token comment" data-v-720ca9e7>// console.log(coordinate);</span>\n        <span class="token comment" data-v-720ca9e7>// coordinate 多边形数据</span>\n        coordinate<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>forEach</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>rows</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>=&gt;</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n          <span class="token keyword" data-v-720ca9e7>const</span> mesh <span class="token operator" data-v-720ca9e7>=</span> <span class="token function" data-v-720ca9e7>drawExtrudeMesh</span><span class="token punctuation" data-v-720ca9e7>(</span>rows<span class="token punctuation" data-v-720ca9e7>,</span> color<span class="token punctuation" data-v-720ca9e7>,</span> projection1<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n          <span class="token keyword" data-v-720ca9e7>const</span> line <span class="token operator" data-v-720ca9e7>=</span> <span class="token function" data-v-720ca9e7>lineDraw</span><span class="token punctuation" data-v-720ca9e7>(</span>rows<span class="token punctuation" data-v-720ca9e7>,</span> color<span class="token punctuation" data-v-720ca9e7>,</span> projection1<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n          <span class="token comment" data-v-720ca9e7>// 唯一标识</span>\n          mesh<span class="token punctuation" data-v-720ca9e7>.</span>properties <span class="token operator" data-v-720ca9e7>=</span> feature<span class="token punctuation" data-v-720ca9e7>.</span>properties<span class="token punctuation" data-v-720ca9e7>.</span>name<span class="token punctuation" data-v-720ca9e7>;</span>\n\n          province<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>add</span><span class="token punctuation" data-v-720ca9e7>(</span>line<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n          province<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>add</span><span class="token punctuation" data-v-720ca9e7>(</span>mesh<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n        <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n      <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n    <span class="token punctuation" data-v-720ca9e7>}</span>\n\n    <span class="token keyword" data-v-720ca9e7>if</span> <span class="token punctuation" data-v-720ca9e7>(</span>feature<span class="token punctuation" data-v-720ca9e7>.</span>geometry<span class="token punctuation" data-v-720ca9e7>.</span>type <span class="token operator" data-v-720ca9e7>===</span> <span class="token string" data-v-720ca9e7>&quot;Polygon&quot;</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n      <span class="token comment" data-v-720ca9e7>// 多边形</span>\n      coordinates<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>forEach</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>coordinate</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>=&gt;</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n        <span class="token keyword" data-v-720ca9e7>const</span> mesh <span class="token operator" data-v-720ca9e7>=</span> <span class="token function" data-v-720ca9e7>drawExtrudeMesh</span><span class="token punctuation" data-v-720ca9e7>(</span>coordinate<span class="token punctuation" data-v-720ca9e7>,</span> color<span class="token punctuation" data-v-720ca9e7>,</span> projection1<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n        <span class="token keyword" data-v-720ca9e7>const</span> line <span class="token operator" data-v-720ca9e7>=</span> <span class="token function" data-v-720ca9e7>lineDraw</span><span class="token punctuation" data-v-720ca9e7>(</span>coordinate<span class="token punctuation" data-v-720ca9e7>,</span> color<span class="token punctuation" data-v-720ca9e7>,</span> projection1<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n        <span class="token comment" data-v-720ca9e7>// 唯一标识</span>\n        mesh<span class="token punctuation" data-v-720ca9e7>.</span>properties <span class="token operator" data-v-720ca9e7>=</span> feature<span class="token punctuation" data-v-720ca9e7>.</span>properties<span class="token punctuation" data-v-720ca9e7>.</span>name<span class="token punctuation" data-v-720ca9e7>;</span>\n\n        province<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>add</span><span class="token punctuation" data-v-720ca9e7>(</span>line<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n        province<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>add</span><span class="token punctuation" data-v-720ca9e7>(</span>mesh<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n      <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n    <span class="token punctuation" data-v-720ca9e7>}</span>\n    map<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>add</span><span class="token punctuation" data-v-720ca9e7>(</span>province<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  scene<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>add</span><span class="token punctuation" data-v-720ca9e7>(</span>map<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n<span class="token punctuation" data-v-720ca9e7>}</span>\n\n<span class="token keyword" data-v-720ca9e7>function</span> <span class="token function" data-v-720ca9e7>lineDraw</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>polygon<span class="token punctuation" data-v-720ca9e7>,</span> color<span class="token punctuation" data-v-720ca9e7>,</span> projection</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n  <span class="token keyword" data-v-720ca9e7>const</span> lineGeometry <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>BufferGeometry</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token keyword" data-v-720ca9e7>const</span> pointsArray <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>Array</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  polygon<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>forEach</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>row</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>=&gt;</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n    <span class="token keyword" data-v-720ca9e7>const</span> <span class="token punctuation" data-v-720ca9e7>[</span>x<span class="token punctuation" data-v-720ca9e7>,</span> y<span class="token punctuation" data-v-720ca9e7>]</span> <span class="token operator" data-v-720ca9e7>=</span> <span class="token function" data-v-720ca9e7>projection</span><span class="token punctuation" data-v-720ca9e7>(</span>row<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n    <span class="token comment" data-v-720ca9e7>// 创建三维点</span>\n    pointsArray<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>push</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>Vector3</span><span class="token punctuation" data-v-720ca9e7>(</span>x<span class="token punctuation" data-v-720ca9e7>,</span> <span class="token operator" data-v-720ca9e7>-</span>y<span class="token punctuation" data-v-720ca9e7>,</span> <span class="token number" data-v-720ca9e7>9</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token comment" data-v-720ca9e7>// 放入多个点</span>\n  lineGeometry<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>setFromPoints</span><span class="token punctuation" data-v-720ca9e7>(</span>pointsArray<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token comment" data-v-720ca9e7>// 生成随机颜色</span>\n  <span class="token keyword" data-v-720ca9e7>const</span> lineColor <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>Color</span><span class="token punctuation" data-v-720ca9e7>(</span>\n    Math<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>random</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>*</span> <span class="token number" data-v-720ca9e7>0.5</span> <span class="token operator" data-v-720ca9e7>+</span> <span class="token number" data-v-720ca9e7>0.5</span><span class="token punctuation" data-v-720ca9e7>,</span>\n    Math<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>random</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>*</span> <span class="token number" data-v-720ca9e7>0.5</span> <span class="token operator" data-v-720ca9e7>+</span> <span class="token number" data-v-720ca9e7>0.5</span><span class="token punctuation" data-v-720ca9e7>,</span>\n    Math<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>random</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>*</span> <span class="token number" data-v-720ca9e7>0.5</span> <span class="token operator" data-v-720ca9e7>+</span> <span class="token number" data-v-720ca9e7>0.5</span>\n  <span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n\n  <span class="token keyword" data-v-720ca9e7>const</span> lineMaterial <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>LineBasicMaterial</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>{</span>\n    <span class="token literal-property property" data-v-720ca9e7>color</span><span class="token operator" data-v-720ca9e7>:</span> lineColor<span class="token punctuation" data-v-720ca9e7>,</span>\n  <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token keyword" data-v-720ca9e7>return</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>Line</span><span class="token punctuation" data-v-720ca9e7>(</span>lineGeometry<span class="token punctuation" data-v-720ca9e7>,</span> lineMaterial<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n<span class="token punctuation" data-v-720ca9e7>}</span>\n\n<span class="token comment" data-v-720ca9e7>// 根据经纬度坐标生成物体</span>\n<span class="token keyword" data-v-720ca9e7>function</span> <span class="token function" data-v-720ca9e7>drawExtrudeMesh</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>polygon<span class="token punctuation" data-v-720ca9e7>,</span> color<span class="token punctuation" data-v-720ca9e7>,</span> projection</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n  <span class="token keyword" data-v-720ca9e7>const</span> shape <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>Shape</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token comment" data-v-720ca9e7>// console.log(polygon, projection);</span>\n  polygon<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>forEach</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token parameter" data-v-720ca9e7>row<span class="token punctuation" data-v-720ca9e7>,</span> i</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>=&gt;</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n    <span class="token keyword" data-v-720ca9e7>const</span> <span class="token punctuation" data-v-720ca9e7>[</span>x<span class="token punctuation" data-v-720ca9e7>,</span> y<span class="token punctuation" data-v-720ca9e7>]</span> <span class="token operator" data-v-720ca9e7>=</span> <span class="token function" data-v-720ca9e7>projection</span><span class="token punctuation" data-v-720ca9e7>(</span>row<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n    <span class="token comment" data-v-720ca9e7>// console.log(row, [x, y]);</span>\n    <span class="token keyword" data-v-720ca9e7>if</span> <span class="token punctuation" data-v-720ca9e7>(</span>i <span class="token operator" data-v-720ca9e7>===</span> <span class="token number" data-v-720ca9e7>0</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n      <span class="token comment" data-v-720ca9e7>// 创建起点,使用moveTo方法</span>\n      <span class="token comment" data-v-720ca9e7>// 因为计算出来的y是反过来，所以要进行颠倒</span>\n      shape<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>moveTo</span><span class="token punctuation" data-v-720ca9e7>(</span>x<span class="token punctuation" data-v-720ca9e7>,</span> <span class="token operator" data-v-720ca9e7>-</span>y<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n    <span class="token punctuation" data-v-720ca9e7>}</span>\n    shape<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>lineTo</span><span class="token punctuation" data-v-720ca9e7>(</span>x<span class="token punctuation" data-v-720ca9e7>,</span> <span class="token operator" data-v-720ca9e7>-</span>y<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n\n  <span class="token comment" data-v-720ca9e7>// 拉伸</span>\n  <span class="token keyword" data-v-720ca9e7>const</span> geometry <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>ExtrudeGeometry</span><span class="token punctuation" data-v-720ca9e7>(</span>shape<span class="token punctuation" data-v-720ca9e7>,</span> <span class="token punctuation" data-v-720ca9e7>{</span>\n    <span class="token literal-property property" data-v-720ca9e7>depth</span><span class="token operator" data-v-720ca9e7>:</span> <span class="token number" data-v-720ca9e7>5</span><span class="token punctuation" data-v-720ca9e7>,</span>\n    <span class="token literal-property property" data-v-720ca9e7>bevelEnabled</span><span class="token operator" data-v-720ca9e7>:</span> <span class="token boolean" data-v-720ca9e7>true</span><span class="token punctuation" data-v-720ca9e7>,</span>\n  <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n\n  <span class="token comment" data-v-720ca9e7>// 随机颜色</span>\n  <span class="token keyword" data-v-720ca9e7>const</span> randomColor <span class="token operator" data-v-720ca9e7>=</span> <span class="token punctuation" data-v-720ca9e7>(</span><span class="token number" data-v-720ca9e7>0.5</span> <span class="token operator" data-v-720ca9e7>+</span> Math<span class="token punctuation" data-v-720ca9e7>.</span><span class="token function" data-v-720ca9e7>random</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>*</span> <span class="token number" data-v-720ca9e7>0.5</span><span class="token punctuation" data-v-720ca9e7>)</span> <span class="token operator" data-v-720ca9e7>*</span> <span class="token number" data-v-720ca9e7>0xffffff</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token keyword" data-v-720ca9e7>const</span> material <span class="token operator" data-v-720ca9e7>=</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>MeshBasicMaterial</span><span class="token punctuation" data-v-720ca9e7>(</span><span class="token punctuation" data-v-720ca9e7>{</span>\n    <span class="token literal-property property" data-v-720ca9e7>color</span><span class="token operator" data-v-720ca9e7>:</span> randomColor<span class="token punctuation" data-v-720ca9e7>,</span>\n    <span class="token literal-property property" data-v-720ca9e7>transparent</span><span class="token operator" data-v-720ca9e7>:</span> <span class="token boolean" data-v-720ca9e7>true</span><span class="token punctuation" data-v-720ca9e7>,</span>\n    <span class="token literal-property property" data-v-720ca9e7>opacity</span><span class="token operator" data-v-720ca9e7>:</span> <span class="token number" data-v-720ca9e7>0.5</span><span class="token punctuation" data-v-720ca9e7>,</span>\n  <span class="token punctuation" data-v-720ca9e7>}</span><span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n  <span class="token keyword" data-v-720ca9e7>return</span> <span class="token keyword" data-v-720ca9e7>new</span> <span class="token class-name" data-v-720ca9e7>THREE<span class="token punctuation" data-v-720ca9e7>.</span>Mesh</span><span class="token punctuation" data-v-720ca9e7>(</span>geometry<span class="token punctuation" data-v-720ca9e7>,</span> material<span class="token punctuation" data-v-720ca9e7>)</span><span class="token punctuation" data-v-720ca9e7>;</span>\n<span class="token punctuation" data-v-720ca9e7>}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true" data-v-720ca9e7><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div><div class="line-number" data-v-720ca9e7></div></div></div>',1),i={__name:"threejs-3d-map.html",setup(a){const n=(0,e.iH)();return(0,t.bv)((()=>{(async()=>{const a=new o.Z;a.dom.style.position="absolute",a.dom.style.top=0,a.dom.style.left=0,n.value.appendChild(a.dom);const s=new c.xsS,t=new c.cPb(90,2,.1,1e3);t.position.set(0,0,100),s.add(t);const e=new c.Tme,l=new c.Ox3(16777215,.5);s.add(l);const i=new c.Mig(16777215,.5);s.add(i);const v=new c.CP7;v.shadowMap.enabled=!0,v.shadowMap.type=c._MY,v.shadowMap.type=c.dwk,v.setSize(n.value.offsetWidth,n.value.offsetWidth/2),window.addEventListener("resize",(()=>{v.setSize(n.value.offsetWidth,n.value.offsetWidth/2),v.setPixelRatio(window.devicePixelRatio)})),n.value.appendChild(v.domElement);const u=v.domElement,r=new p.z(t,v.domElement);r.enableDamping=!0;const k=new c.SUY;!function n(e){r.update(),a.update(),k.getDelta(),requestAnimationFrame(n),v.render(s,t)}();const m=d.mw4().center([116,39]).translate([0,0,0]);function b(a,n,s){const t=new c.u9r,e=new Array;a.forEach((a=>{const[n,t]=s(a);e.push(new c.Pa4(n,-t,9))})),t.setFromPoints(e);const p=new c.Ilk(.5*Math.random()+.5,.5*Math.random()+.5,.5*Math.random()+.5),o=new c.nls({color:p});return new c.x12(t,o)}function y(a,n,s){const t=new c.bnF;a.forEach(((a,n)=>{const[e,c]=s(a);0===n&&t.moveTo(e,-c),t.lineTo(e,-c)}));const e=new c.O7d(t,{depth:5,bevelEnabled:!0}),p=16777215*(.5+.5*Math.random()),o=new c.vBJ({color:p,transparent:!0,opacity:.5});return new c.Kj0(e,o)}(new c.hH6).load("/geojson/china.json",(a=>{JSON.parse(a).features.forEach((a=>{const n=new c.Tme;n.properties=a.properties.name;const s=a.geometry.coordinates;"MultiPolygon"===a.geometry.type&&s.forEach((s=>{s.forEach((s=>{const t=y(s,0,m),e=b(s,0,m);t.properties=a.properties.name,n.add(e),n.add(t)}))})),"Polygon"===a.geometry.type&&s.forEach((s=>{const t=y(s,0,m),e=b(s,0,m);t.properties=a.properties.name,n.add(e),n.add(t)})),e.add(n)})),s.add(e)})),window.addEventListener("click",(function(a){let n=function(a){let n={x:0,y:0};const s=function(a){const n=u.getBoundingClientRect();return{x:(a.clientX-n.left)*u.width/n.width,y:(a.clientY-n.top)*u.height/n.height}}(a);return n.x=s.x/u.width*2-1,n.y=s.y/u.height*-2+1,n}(a);const s=new c.iMs;s.setFromCamera(n,t);const p=s.intersectObjects([e],!0);p.length>0?(w&&w.object.properties!==p[0].object.properties&&(w.object.material.color.set("#99ff99"),w=null),p[0].object.properties&&p[0].object.material.color.set("red"),w=p[0]):w&&w.object.properties&&(w.object.material.color.set("yellow"),w=null)}));let w=null})()})),(a,s)=>((0,t.wg)(),(0,t.iD)("div",null,[l,(0,t._)("div",{ref_key:"mapRef",ref:n,class:"ref-container"},null,512)]))}},v=(0,s(61935).Z)(i,[["__scopeId","data-v-720ca9e7"]])},42869:(a,n,s)=>{s.r(n),s.d(n,{data:()=>t});const t=JSON.parse('{"key":"v-79c23612","path":"/threejs/threejs-3d-map.html","title":"ThreeJS中的GeoJSON地图","lang":"zh-CN","frontmatter":{"title":"ThreeJS中的GeoJSON地图","category":["ThreeJS"],"date":"2022-04-02T00:00:00.000Z","summary":"import {ref,onMounted} from \'vue\' import * as THREE from \'three\' import { CSM } from \'three/examples/jsm/csm/CSM.js\'; import { CSMHelper } from \'three/examples/jsm/csm/CSMHelper.js","head":[["meta",{"property":"og:url","content":"https://luxiag.github.io/threejs/threejs-3d-map.html"}],["meta",{"property":"og:title","content":"ThreeJS中的GeoJSON地图"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2023-04-27T03:25:07.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:published_time","content":"2022-04-02T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-04-27T03:25:07.000Z"}]]},"excerpt":"","headers":[],"git":{"createdTime":1682236028000,"updatedTime":1682565907000,"contributors":[{"name":"卢祥","email":"example@qq.com","commits":3}]},"readingTime":{"minutes":3.57,"words":1071},"filePathRelative":"threejs/threejs-3d-map.md","localizedDate":"2022年4月2日"}')}}]);