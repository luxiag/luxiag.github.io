"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[2753],{6725:(n,s,a)=>{a.r(s),a.d(s,{default:()=>i});var e=a(1534);const t=a.p+"assets/img/image-20210904165252768.ffd7cb76.png",p=a.p+"assets/img/image-20210904170248492.9533b291.png",o=a.p+"assets/img/image-20210904205927222.aa24de4b.png",c=[(0,e.uE)('<p>Loader是用于对模块的源代码进行转换（处理），之前我们已经使用过很多Loader，比如css-loader、style-loader、babel-loader等。</p><h2 id="loader本质" tabindex="-1"><a class="header-anchor" href="#loader本质" aria-hidden="true">#</a> loader本质</h2><p>Loader本质上是一个导出为函数的JavaScript模块； loader runner库会调用这个函数，然后将上一个loader产生的结果或者资源文件传入进去；</p><p>loader返回必须是一个buffer或者<code>javascript字符串</code></p><p><code>自定义loader</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//content：资源文件的内容；</span>\n<span class="token comment">//map：sourcemap相关的数据；</span>\n<span class="token comment">//meta：一些元数据</span>\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span>map<span class="token punctuation">,</span>meta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token string">&quot;自定义loader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> content<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>webpack.config.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">context</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>\n        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token string">&quot;./custom-loader/custom-loader&quot;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="'+t+'" alt="image-20210904165252768"></p><h2 id="resolveloader" tabindex="-1"><a class="header-anchor" href="#resolveloader" aria-hidden="true">#</a> <code>resolveLoader</code></h2><p>指定loader所在的位置</p><p><code>webpack.config.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">mode</span><span class="token operator">:</span> development<span class="token punctuation">,</span>\n  <span class="token literal-property property">context</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>\n        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token string">&quot;custom-loader01&quot;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">resolveLoader</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./custom-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="'+p+'" alt="image-20210904170248492"></p><h2 id="loader执行顺序" tabindex="-1"><a class="header-anchor" href="#loader执行顺序" aria-hidden="true">#</a> loader执行顺序</h2><p>loader 总是 从右到左被调用。有些情况下，loader 只关心 request 后面的 元数据(metadata)，并且忽略前一个 loader 的结果。在实际（从右到左）执行 loader 之前，会先 从左到右 调用 loader 上的 pitch 方法。</p><p><img src="images/webpack进阶/image-20210904174723961.png" alt="image-20210904174723961"></p><h2 id="enforce" tabindex="-1"><a class="header-anchor" href="#enforce" aria-hidden="true">#</a> <strong>enforce</strong></h2><p>指定 loader 种类。没有值表示是普通 loader。</p><p><strong>Pitching 阶段:</strong> loader 上的 pitch 方法，按照 后置(post)、行内(inline)、普通(normal)、前置(pre) 的顺序调用。 <strong>Normal 阶段:</strong> loader 上的 常规方法，按照 前置(pre)、普通(normal)、行内(inline)、后置(post) 的顺序调用。模块源码的转换， 发生在这个阶段。</p><p><code>webpack.config.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>\n    <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>\n    <span class="token literal-property property">use</span><span class="token operator">:</span><span class="token string">&#39;loader&#39;</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">enforce</span><span class="token operator">:</span><span class="token string">&#39;pre&#39;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="同步loader" tabindex="-1"><a class="header-anchor" href="#同步loader" aria-hidden="true">#</a> 同步loader</h2><p>默认创建的Loader就是同步的Loader； 这个Loader必须通过 return 或者 <code>this.callback </code>来返回结果，交给下一个loader来处理； 通常在有错误的情况下，我们会使用 <code>this.callback</code>；</p><p><code>webpack.config.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span><span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    \n     <span class="token comment">// return content</span>\n    <span class="token comment">//第一个参数必须是 Error 或者 null；</span>\n    <span class="token comment">//第二个参数是一个 string或者Buffer；</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="异步loader" tabindex="-1"><a class="header-anchor" href="#异步loader" aria-hidden="true">#</a> 异步loader</h2><p><code>webpack.config.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="获取传入参数" tabindex="-1"><a class="header-anchor" href="#获取传入参数" aria-hidden="true">#</a> 获取传入参数</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> i loader-utils\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>webpack.config.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>      <span class="token punctuation">{</span>\n        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>\n        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;custom-loader01&quot;</span><span class="token punctuation">,</span>\n          <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;lu&quot;</span><span class="token punctuation">,</span>\n            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">,</span>\n          <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>custom-loader.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> getOptions <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;loader-utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">//NormalLoader</span>\n<span class="token comment">//异步</span>\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token string">&quot;options&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="data:image/png;base64,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" alt="image-20210904205745311"></p><h2 id="校验传入参数" tabindex="-1"><a class="header-anchor" href="#校验传入参数" aria-hidden="true">#</a> 校验传入参数</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> i schema-utils <span class="token parameter variable">-D</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>custom-schema.json</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>\n      <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;名字&quot;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span>\n      <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;年龄&quot;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>webpack.config.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>      <span class="token punctuation">{</span>\n        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>\n        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;custom-loader01&quot;</span><span class="token punctuation">,</span>\n          <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;lu&quot;</span><span class="token punctuation">,</span>\n            <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">,</span>\n          <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>custom-loader.js</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> getOptions <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;loader-utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> validate <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;schema-utils&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../custom-schema/custom-schema.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">//NormalLoader</span>\n<span class="token comment">//异步</span>\nmodule<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token string">&quot;options&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">validate</span><span class="token punctuation">(</span>schema<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="'+o+'" alt="image-20210904205927222"></p>',45)],l={},i=(0,a(1935).Z)(l,[["render",function(n,s){return(0,e.wg)(),(0,e.iD)("div",null,c)}]])},1935:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,e]of s)a[n]=e;return a}},31:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e=JSON.parse('{"key":"v-44165836","path":"/webpack/custom-loader.html","title":"自定义loader","lang":"zh-CN","frontmatter":{"title":"自定义loader","category":["Webpack"],"tag":["Webpack5"],"date":"2021-10-12T00:00:00.000Z","summary":"Loader是用于对模块的源代码进行转换（处理），之前我们已经使用过很多Loader，比如css-loader、style-loader、babel-loader等。 loader本质 Loader本质上是一个导出为函数的JavaScript模块； loader runner库会调用这个函数，然后将上一个loader产生的结果或者资源文件传入进去； load","head":[["meta",{"property":"og:url","content":"https://luxiag.github.io/webpack/custom-loader.html"}],["meta",{"property":"og:title","content":"自定义loader"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://luxiag.github.io/"}],["meta",{"property":"og:updated_time","content":"2023-01-08T13:32:53.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:alt","content":"自定义loader"}],["meta",{"property":"article:tag","content":"Webpack5"}],["meta",{"property":"article:published_time","content":"2021-10-12T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-01-08T13:32:53.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"loader本质","slug":"loader本质","link":"#loader本质","children":[]},{"level":2,"title":"resolveLoader","slug":"resolveloader","link":"#resolveloader","children":[]},{"level":2,"title":"loader执行顺序","slug":"loader执行顺序","link":"#loader执行顺序","children":[]},{"level":2,"title":"enforce","slug":"enforce","link":"#enforce","children":[]},{"level":2,"title":"同步loader","slug":"同步loader","link":"#同步loader","children":[]},{"level":2,"title":"异步loader","slug":"异步loader","link":"#异步loader","children":[]},{"level":2,"title":"获取传入参数","slug":"获取传入参数","link":"#获取传入参数","children":[]},{"level":2,"title":"校验传入参数","slug":"校验传入参数","link":"#校验传入参数","children":[]}],"git":{"createdTime":1673184773000,"updatedTime":1673184773000,"contributors":[{"name":"luxiag","email":"luxiag@qq.com","commits":1}]},"readingTime":{"minutes":2.3,"words":691},"filePathRelative":"webpack/custom-loader.md","localizedDate":"2021年10月12日"}')}}]);